<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Upgraded Space Shooter</title>
<style>
  body { margin:0; background:black; overflow:hidden; }
  canvas { display:block; margin:auto; background:#000; }
  #score, #level, #lives { color:white; font-family:sans-serif; position:absolute; top:10px; }
  #level { left:150px; }
  #lives { right:10px; }
</style>
</head>
<body>
<div id="score">Score: 0</div>
<div id="level">Level: 1</div>
<div id="lives">Lives: 3</div>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const player = { x:180, y:520, width:40, height:40, speed:5, lives:3 };
let bullets = [];
let enemies = [];
let powerUps = [];
let score = 0;
let level = 1;
let gameOver = false;
let frame = 0;

const keys = {};
document.addEventListener('keydown', (e)=>keys[e.key]=true);
document.addEventListener('keyup', (e)=>keys[e.key]=false);

// Shoot bullets
function shoot() {
    bullets.push({x:player.x+player.width/2-2, y:player.y, width:4, height:10, speed:7});
}

// Enemy spawn
function createEnemy() {
    const x = Math.random()*(canvas.width-30);
    const type = Math.random()<0.5?1:2; // 2 types
    enemies.push({x:x, y:-30, width:30, height:30, speed: type===1?2+Math.random()*1:3+Math.random()*2, type:type});
}

// Power-up spawn
function createPowerUp() {
    const x = Math.random()*(canvas.width-20);
    powerUps.push({x:x, y:-20, width:20, height:20, speed:2});
}

// Collision
function isColliding(a,b){
    return a.x<a.x+b.width && a.x+a.width>b.x && a.y<a.y+b.height && a.y+a.height>b.y;
}

// Update game state
function update(){
    if(gameOver) return;
    frame++;

    // Move player
    if(keys['ArrowLeft'] && player.x>0) player.x-=player.speed;
    if(keys['ArrowRight'] && player.x<canvas.width-player.width) player.x+=player.speed;
    if(keys[' '] && frame%10===0) shoot();

    // Update bullets
    bullets.forEach((b,i)=>{ b.y-=b.speed; if(b.y<0) bullets.splice(i,1); });

    // Update enemies
    enemies.forEach((e,i)=>{
        e.y+=e.speed;
        // Collision with player
        if(isColliding(e, player)){
            enemies.splice(i,1);
            player.lives--;
            document.getElementById('lives').innerText="Lives: "+player.lives;
            if(player.lives<=0) gameOver=true;
        }
        // Bullet hits enemy
        bullets.forEach((b,j)=>{
            if(isColliding(b,e)){
                bullets.splice(j,1);
                enemies.splice(i,1);
                score+= e.type===1?10:20;
                document.getElementById('score').innerText="Score: "+score;
            }
        });
        if(e && e.y>canvas.height) enemies.splice(i,1);
    });

    // Power-ups
    powerUps.forEach((p,i)=>{
        p.y+=p.speed;
        if(isColliding(p,player)){
            powerUps.splice(i,1);
            player.lives++;
            document.getElementById('lives').innerText="Lives: "+player.lives;
        }
        if(p.y>canvas.height) powerUps.splice(i,1);
    });

    // Spawn enemies
    if(frame%60===0) createEnemy();
    // Spawn power-ups
    if(frame%600===0) createPowerUp();

    // Level up
    if(score>=level*100){
        level++;
        document.getElementById('level').innerText="Level: "+level;
    }

    draw();
    requestAnimationFrame(update);
}

// Draw everything
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Background stars
    for(let i=0;i<100;i++){
        ctx.fillStyle='white';
        ctx.fillRect(Math.random()*canvas.width, Math.random()*canvas.height, 1,1);
    }

    // Player
    ctx.fillStyle='lime';
    ctx.fillRect(player.x, player.y, player.width, player.height);

    // Bullets
    ctx.fillStyle='yellow';
    bullets.forEach(b=>ctx.fillRect(b.x,b.y,b.width,b.height));

    // Enemies
    ctx.fillStyle='red';
    enemies.forEach(e=>ctx.fillRect(e.x,e.y,e.width,e.height));

    // Power-ups
    ctx.fillStyle='cyan';
    powerUps.forEach(p=>ctx.fillRect(p.x,p.y,p.width,p.height));

    // Game over
    if(gameOver){
        ctx.fillStyle='white';
        ctx.font='30px sans-serif';
        ctx.fillText('GAME OVER', 100, 300);
    }
}

update();
</script>
</body>
</html>
