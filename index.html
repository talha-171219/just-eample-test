<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pro Space Shooter</title>
<style>
  body { margin:0; background:black; overflow:hidden; }
  canvas { display:block; margin:auto; background:#000; }
  #score, #level, #lives { color:white; font-family:sans-serif; position:absolute; top:10px; font-weight:bold; }
  #level { left:150px; }
  #lives { right:10px; }
</style>
</head>
<body>
<div id="score">Score: 0</div>
<div id="level">Level: 1</div>
<div id="lives">Lives: 3</div>
<canvas id="gameCanvas" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const playerImg = new Image();
playerImg.src = 'https://i.ibb.co/3C2Q0Zf/playerShip.png'; // placeholder
const enemyImg = new Image();
enemyImg.src = 'https://i.ibb.co/0Q5F4tY/enemyShip.png'; // placeholder
const explosionImg = new Image();
explosionImg.src = 'https://i.ibb.co/xLQ0y3q/explosion.png'; // placeholder

// Sounds
const shootSound = new Audio('https://freesound.org/data/previews/320/320655_5260870-lq.mp3'); 
const explosionSound = new Audio('https://freesound.org/data/previews/235/235968_3989450-lq.mp3'); 
const bgMusic = new Audio('https://freesound.org/data/previews/331/331912_3248244-lq.mp3'); 
bgMusic.loop = true;
bgMusic.volume = 0.3;
bgMusic.play();

const player = { x:180, y:520, width:40, height:40, speed:5, lives:3 };
let bullets = [];
let enemies = [];
let powerUps = [];
let explosions = [];
let score = 0;
let level = 1;
let gameOver = false;
let frame = 0;

const keys = {};
document.addEventListener('keydown', e=>keys[e.key]=true);
document.addEventListener('keyup', e=>keys[e.key]=false);

// Mobile controls (simple)
canvas.addEventListener('touchstart', e=>{
    const touchX = e.touches[0].clientX - canvas.getBoundingClientRect().left;
    if(touchX < canvas.width/2) player.x -= player.speed;
    else player.x += player.speed;
    shoot();
});

function shoot() {
    bullets.push({x:player.x+player.width/2-2, y:player.y, width:4, height:10, speed:7});
    shootSound.currentTime = 0; shootSound.play();
}

function createEnemy() {
    const x = Math.random()*(canvas.width-30);
    const type = Math.random()<0.5?1:2;
    enemies.push({x:x, y:-30, width:30, height:30, speed: type===1?2+Math.random()*1:3+Math.random()*2, type:type});
}

function createPowerUp() {
    const x = Math.random()*(canvas.width-20);
    powerUps.push({x:x, y:-20, width:20, height:20, speed:2});
}

function isColliding(a,b){
    return a.x<a.x+b.width && a.x+a.width>b.x && a.y<a.y+b.height && a.y+a.height>b.y;
}

function update(){
    if(gameOver) return;
    frame++;

    if(keys['ArrowLeft'] && player.x>0) player.x-=player.speed;
    if(keys['ArrowRight'] && player.x<canvas.width-player.width) player.x+=player.speed;
    if(keys[' '] && frame%10===0) shoot();

    bullets.forEach((b,i)=>{ b.y-=b.speed; if(b.y<0) bullets.splice(i,1); });

    enemies.forEach((e,i)=>{
        e.y+=e.speed;
        if(isColliding(e, player)){
            enemies.splice(i,1);
            player.lives--;
            document.getElementById('lives').innerText="Lives: "+player.lives;
            explosions.push({x:player.x-10, y:player.y-10, frame:0});
            explosionSound.currentTime=0; explosionSound.play();
            if(player.lives<=0) gameOver=true;
        }
        bullets.forEach((b,j)=>{
            if(isColliding(b,e)){
                bullets.splice(j,1);
                enemies.splice(i,1);
                explosions.push({x:e.x-10, y:e.y-10, frame:0});
                explosionSound.currentTime=0; explosionSound.play();
                score+= e.type===1?10:20;
                document.getElementById('score').innerText="Score: "+score;
            }
        });
        if(e && e.y>canvas.height) enemies.splice(i,1);
    });

    powerUps.forEach((p,i)=>{
        p.y+=p.speed;
        if(isColliding(p,player)){
            powerUps.splice(i,1);
            player.lives++;
            document.getElementById('lives').innerText="Lives: "+player.lives;
        }
        if(p.y>canvas.height) powerUps.splice(i,1);
    });

    // Enemy spawn
    if(frame%60===0) createEnemy();
    // Power-up spawn
    if(frame%600===0) createPowerUp();
    // Level up
    if(score>=level*100){
        level++;
        document.getElementById('level').innerText="Level: "+level;
    }

    draw();
    requestAnimationFrame(update);
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // Background stars
    for(let i=0;i<50;i++){
        ctx.fillStyle='white';
        ctx.fillRect(Math.random()*canvas.width, Math.random()*canvas.height, 1,1);
    }
    // Player
    ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);
    // Bullets
    ctx.fillStyle='yellow';
    bullets.forEach(b=>ctx.fillRect(b.x,b.y,b.width,b.height));
    // Enemies
    enemies.forEach(e=>ctx.drawImage(enemyImg,e.x,e.y,e.width,e.height));
    // Power-ups
    ctx.fillStyle='cyan';
    powerUps.forEach(p=>ctx.fillRect(p.x,p.y,p.width,p.height));
    // Explosions
    explosions.forEach((ex,i)=>{
        ctx.drawImage(explosionImg, ex.x, ex.y, 40, 40);
        ex.frame++;
        if(ex.frame>10) explosions.splice(i,1);
    });

    if(gameOver){
        ctx.fillStyle='white';
        ctx.font='30px sans-serif';
        ctx.fillText('GAME OVER', 100, 300);
        bgMusic.pause();
    }
}

update();
</script>
</body>
</html>
